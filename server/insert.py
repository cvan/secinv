#!/usr/bin/env python26

from __future__ import with_statement

import datetime
import os
import sys

def diff_list(l_old, l_new):
    """
    Creates a new dict representing a diff between two lists.
    """

    set_new, set_past = set(l_new), set(l_old)
    intersect = set_new.intersection(set_past)

    added = list(set_new - intersect)
    deleted = list(set_past - intersect)

    # Added and deleted items.
    diff = {'added': added, 'deleted': deleted}

    return diff


# BASE_PATH is the absolute path of '..' relative to this script location.
BASE_PATH = reduce(lambda l, r: l + os.path.sep + r,
    os.path.dirname(os.path.realpath(__file__)).split(os.path.sep)[:-1])

# Append settings directory.
sys.path.append(os.path.join(BASE_PATH, 'secinv'))

from django.core.management import execute_manager
try:
    import settings
except:
    print "Could not import settings"
    sys.exit(1)

# To suppress MySQLdb and haystack warnings.
import warnings
warnings.filterwarnings("ignore", category=DeprecationWarning)

from django.core.management import setup_environ
setup_environ(settings)

import reversion

from apps.machines.models import *


ip_dict = {'sit0': {'i_mac': '00:00:00:00', 'i_mask': '', 'i_ip': ''}, 'lo': {'i_mac': '00:00:00:00:00:06', 'i_mask': '255.0.0.0', 'i_ip': '127.0.0.1'}, 'eth0': {'i_mac': '01:50:56:a5:11:39', 'i_mask': '255.255.255.0', 'i_ip': '10.2.72.89'}}
ip_dict = {'sit0': {'i_mac': '00:00:00:00', 'i_mask': '', 'i_ip': ''}, 'eth0': {'i_mac': '01:50:56:a5:11:39', 'i_mask': '255.255.255.0', 'i_ip': '10.2.72.89'}}

system_dict = {'kernel_rel': '2.8.18-194.3.1.el5', 'hostname': 'cm-sectest02', 'nfs': 0, 'rh_rel': '5.5 (Tikanga)', 'ip_fwd': 0}

services_dict = {'rpc.statd': '869', 'sshd': '22', 'sendmail': '25', 'nrpe': '5666', 'portmap': '111', 'mysqld': '3366', 'snmpd': '199'}
services_dict = {'httpd': '80', 'sshd': '22', 'sendmail': '25', 'nrpe': '5666', 'portmap': '111', 'mysqld': '3306', 'snmpd': '199', 'openvpn': '1194'}

rpms_dict = {
'list': 'quartz-1.0.2.rpm\nDeeployment_Guide-en-US-5.2-11.noarch.rpm\nGConf2-2.14.0-9.el5.x86_64.rpm\nMAKEDEV-3.23-1.2.x86_64.rpm\nNetworkManager-0.7.0-10.el5.i386.rpm\nNetworkManager-0.7.0-10.el5.x86_64.rpm\nNetworkManager-glib-0.7.0-10.el5.i386.rpm\nNetworkManager-glib-0.7.0-10.el5.x86_64.rpm\nORBit2-2.14.3-5.el5.x86_64.rpm\nSysVinit-2.86-15.el5.x86_64.rpm\nacl-2.2.39-6.el5.x86_64.rpm\nacpid-1.0.4-9.el5_4.2.x86_64.rpm\namtu-1.0.6-1.el5.x86_64.rpm\nanacron-2.3-45.el5.x86_64.rpm\napr-1.2.7-11.el5_3.1.x86_64.rpm\napr-util-1.2.7-11.el5.x86_64.rpm\naspell-0.60.3-7.1.i386.rpm\naspell-0.60.3-7.1.x86_64.rpm\naspell-en-6.0-2.1.x86_64.rpm\nat-3.1.8-84.el5.x86_64.rpm\natk-1.12.2-1.fc6.x86_64.rpm\nattr-2.4.32-1.1.x86_64.rpm\naudit-1.7.17-3.el5.x86_64.rpm\naudit-libs-1.7.17-3.el5.i386.rpm\naudit-libs-1.7.17-3.el5.x86_64.rpm\naudit-libs-python-1.7.17-3.el5.x86_64.rpm\naugeas-libs-0.6.0-2.el5.x86_64.rpm\nauthconfig-5.3.21-6.el5.x86_64.rpm\nautofs-5.0.1-0.rc2.143.el5.x86_64.rpm\navahi-0.6.16-7.el5.x86_64.rpm\navahi-compat-libdns_sd-0.6.16-7.el5.x86_64.rpm\nbasesystem-8.0-5.1.1.noarch.rpm\nbash-3.2-24.el5.x86_64.rpm\nbc-1.06-21.x86_64.rpm\nbind-libs-9.3.6-4.P1.el5_4.2.x86_64.rpm\nbind-utils-9.3.6-4.P1.el5_4.2.x86_64.rpm\nbinutils-2.17.50.0.6-14.el5.x86_64.rpm\nbitstream-vera-fonts-1.10-7.noarch.rpm\nbluez-gnome-0.5-5.fc6.x86_64.rpm\nbluez-libs-3.7-1.1.x86_64.rpm\nbluez-utils-3.7-2.2.x86_64.rpm\nbzip2-1.0.3-4.el5_2.x86_64.rpm\nbzip2-libs-1.0.3-4.el5_2.x86_64.rpm\ncairo-1.2.4-5.el5.x86_64.rpm\nccid-1.3.8-1.el5.x86_64.rpm\ncheckpolicy-1.33.1-6.el5.x86_64.rpm\nchkconfig-1.3.30.2-2.el5.x86_64.rpm\nconman-0.1.9.2-8.el5.x86_64.rpm\ncoolkey-1.1.0-14.el5.i386.rpm\ncoolkey-1.1.0-14.el5.x86_64.rpm\ncoreutils-5.97-23.el5_4.2.x86_64.rpm\ncpio-2.6-23.el5_4.1.x86_64.rpm\ncpp-4.1.2-48.el5.x86_64.rpm\ncpuspeed-1.2.1-9.el5.x86_64.rpm\ncracklib-2.8.9-3.3.i386.rpm\ncracklib-2.8.9-3.3.x86_64.rpm\ncracklib-dicts-2.8.9-3.3.x86_64.rpm\ncrash-4.1.2-4.el5.x86_64.rpm\ncrontabs-1.10-8.noarch.rpm\ncryptsetup-luks-1.0.3-5.el5.i386.rpm\ncryptsetup-luks-1.0.3-5.el5.x86_64.rpm\ncups-1.3.7-18.el5.x86_64.rpm\ncups-libs-1.3.7-18.el5.x86_64.rpm\ncurl-7.15.5-9.el5.x86_64.rpm\ncyrus-sasl-2.1.22-5.el5_4.3.x86_64.rpm\ncyrus-sasl-lib-2.1.22-5.el5_4.3.i386.rpm\ncyrus-sasl-lib-2.1.22-5.el5_4.3.x86_64.rpm\ncyrus-sasl-plain-2.1.22-5.el5_4.3.i386.rpm\ncyrus-sasl-plain-2.1.22-5.el5_4.3.x86_64.rpm\ndb4-4.3.29-10.el5.i386.rpm\ndb4-4.3.29-10.el5.x86_64.rpm\ndbus-1.1.2-14.el5.x86_64.rpm\ndbus-glib-0.73-8.el5.i386.rpm\ndbus-glib-0.73-8.el5.x86_64.rpm\ndbus-libs-1.1.2-14.el5.i386.rpm\ndbus-libs-1.1.2-14.el5.x86_64.rpm\ndbus-python-0.70-9.el5_4.x86_64.rpm\ndesktop-file-utils-0.10-7.x86_64.rpm\ndevice-mapper-1.02.39-1.el5.i386.rpm\ndevice-mapper-1.02.39-1.el5.x86_64.rpm\ndevice-mapper-event-1.02.39-1.el5.x86_64.rpm\ndevice-mapper-multipath-0.4.7-34.el5_5.1.x86_64.rpm\ndhclient-3.0.5-23.el5.x86_64.rpm\ndhcpv6-client-1.0.10-18.el5.x86_64.rpm\ndiffutils-2.8.1-15.2.3.el5.x86_64.rpm\ndmidecode-2.10-3.el5.x86_64.rpm\ndmraid-1.0.0.rc13-63.el5.x86_64.rpm\ndmraid-events-1.0.0.rc13-63.el5.x86_64.rpm\ndnsmasq-2.51-1.el5.rf.x86_64.rpm\ndos2unix-3.1-27.2.el5.x86_64.rpm\ndosfstools-2.11-9.el5.x86_64.rpm\ndump-0.4b41-4.el5.x86_64.rpm\ne2fsprogs-1.39-23.el5.x86_64.rpm\ne2fsprogs-libs-1.39-23.el5.i386.rpm\ne2fsprogs-libs-1.39-23.el5.x86_64.rpm\ned-0.2-39.el5_2.x86_64.rpm\neject-2.1.5-4.2.el5.x86_64.rpm\nelfutils-libelf-0.137-3.el5.x86_64.rpm\nethtool-6-4.el5.x86_64.rpm\nexpat-1.95.8-8.3.el5_4.2.i386.rpm\nexpat-1.95.8-8.3.el5_4.2.x86_64.rpm\nfacter-1.5.7-1.rhel5.x86_64.rpm\nfbset-2.1-22.x86_64.rpm\nfile-4.17-15.el5_3.1.x86_64.rpm\nfilesystem-2.4.0-3.el5.x86_64.rpm\nfindutils-4.2.27-6.el5.x86_64.rpm\nfinger-0.17-32.2.1.1.x86_64.rpm\nfipscheck-1.2.0-1.el5.x86_64.rpm\nfipscheck-lib-1.2.0-1.el5.x86_64.rpm\nfirstboot-tui-1.4.27.8-1.el5.x86_64.rpm\nfontconfig-2.4.1-7.el5.x86_64.rpm\nfping-2.4-1.b2.2.el5.rf.x86_64.rpm\nfreetype-2.2.1-21.el5_3.x86_64.rpm\nftp-0.17-35.el5.x86_64.rpm\ngamin-0.1.7-8.el5.x86_64.rpm\ngamin-python-0.1.7-8.el5.x86_64.rpm\ngawk-3.1.5-14.el5.x86_64.rpm\ngcc-4.1.2-48.el5.x86_64.rpm\ngdbm-1.8.0-26.2.1.x86_64.rpm\ngettext-0.14.6-4.el5.x86_64.rpm\ngit-1.7.1-1.x86_64.rpm\nglib2-2.12.3-4.el5_3.1.i386.rpm\nglib2-2.12.3-4.el5_3.1.x86_64.rpm\nglibc-2.5-49.i686.rpm\nglibc-2.5-49.x86_64.rpm\nglibc-common-2.5-49.x86_64.rpm\nglibc-devel-2.5-49.x86_64.rpm\nglibc-headers-2.5-49.x86_64.rpm\ngnupg-1.4.5-14.x86_64.rpm\ngnutls-1.4.1-3.el5_4.8.x86_64.rpm\ngpg-pubkey-37017186-45761324.(none).rpm\ngpg-pubkey-6b8d79e6-3f49313d.(none).rpm\ngpm-1.20.1-74.1.i386.rpm\ngpm-1.20.1-74.1.x86_64.rpm\ngrep-2.5.1-55.el5.x86_64.rpm\ngroff-1.18.1.1-11.1.x86_64.rpm\ngrub-0.97-13.5.x86_64.rpm\ngtk2-2.10.4-20.el5.x86_64.rpm\ngzip-1.3.5-11.el5_4.1.x86_64.rpm\nhal-0.5.8.1-59.el5.i386.rpm\nhal-0.5.8.1-59.el5.x86_64.rpm\nhdparm-6.6-2.x86_64.rpm\nhesiod-3.1.0-8.x86_64.rpm\nhicolor-icon-theme-0.9-2.1.noarch.rpm\nhmaccalc-0.9.6-3.el5.x86_64.rpm\nhtmlview-4.0.0-2.el5.noarch.rpm\nhttpd-2.2.3-43.el5.x86_64.rpm\nhwdata-0.213.18-1.el5.1.noarch.rpm\nifd-egate-0.05-15.x86_64.rpm\ninfo-4.8-14.el5.x86_64.rpm\ninitscripts-8.45.30-2.el5.x86_64.rpm\niproute-2.6.18-11.el5.x86_64.rpm\nipsec-tools-0.6.5-13.el5_3.1.x86_64.rpm\niptables-1.3.5-5.3.el5_4.1.x86_64.rpm\niptables-ipv6-1.3.5-5.3.el5_4.1.x86_64.rpm\niptstate-1.4-2.el5.x86_64.rpm\niputils-20020927-46.el5.x86_64.rpm\nirda-utils-0.9.17-2.fc6.x86_64.rpm\nirqbalance-0.55-15.el5.x86_64.rpm\njwhois-3.2.3-8.el5.x86_64.rpm\nkbd-1.12-21.el5.x86_64.rpm\nkernel-2.6.18-194.3.1.el5.x86_64.rpm\nkernel-2.6.18-194.el5.x86_64.rpm\nkernel-devel-2.6.18-194.3.1.el5.x86_64.rpm\nkernel-devel-2.6.18-194.el5.x86_64.rpm\nkernel-headers-2.6.18-194.3.1.el5.x86_64.rpm\nkeyutils-libs-1.2-1.el5.i386.rpm\nkeyutils-libs-1.2-1.el5.x86_64.rpm\nkpartx-0.4.7-34.el5_5.1.x86_64.rpm\nkrb5-libs-1.6.1-36.el5_5.2.i386.rpm\nkrb5-libs-1.6.1-36.el5_5.2.x86_64.rpm\nkrb5-workstation-1.6.1-36.el5_5.2.x86_64.rpm\nksh-20100202-1.el5.x86_64.rpm\nkudzu-1.2.57.1.24-1.x86_64.rpm\nless-436-2.el5.x86_64.rpm\nlftp-4.0.7-1.el5.rf.x86_64.rpm\nlibICE-1.0.1-2.1.i386.rpm\nlibICE-1.0.1-2.1.x86_64.rpm\nlibIDL-0.8.7-1.fc6.x86_64.rpm\nlibSM-1.0.1-3.1.i386.rpm\nlibSM-1.0.1-3.1.x86_64.rpm\nlibX11-1.0.3-11.el5.i386.rpm\nlibX11-1.0.3-11.el5.x86_64.rpm\nlibXau-1.0.1-3.1.i386.rpm\nlibXau-1.0.1-3.1.x86_64.rpm\nlibXcursor-1.1.7-1.1.x86_64.rpm\nlibXdmcp-1.0.1-2.1.i386.rpm\nlibXdmcp-1.0.1-2.1.x86_64.rpm\nlibXext-1.0.1-2.1.i386.rpm\nlibXext-1.0.1-2.1.x86_64.rpm\nlibXfixes-4.0.1-2.1.x86_64.rpm\nlibXft-2.1.10-1.1.x86_64.rpm\nlibXi-1.0.1-4.el5_4.i386.rpm\nlibXi-1.0.1-4.el5_4.x86_64.rpm\nlibXinerama-1.0.1-2.1.x86_64.rpm\nlibXrandr-1.1.1-3.3.x86_64.rpm\nlibXrender-0.9.1-3.1.x86_64.rpm\nlibXres-1.0.1-3.1.x86_64.rpm\nlibXt-1.0.2-3.2.el5.i386.rpm\nlibXt-1.0.2-3.2.el5.x86_64.rpm\nlibXxf86vm-1.0.1-3.1.i386.rpm\nlibXxf86vm-1.0.1-3.1.x86_64.rpm\nlibacl-2.2.39-6.el5.x86_64.rpm\nlibaio-0.3.106-5.i386.rpm\nlibaio-0.3.106-5.x86_64.rpm\nlibattr-2.4.32-1.1.x86_64.rpm\nlibcap-1.10-26.i386.rpm\nlibcap-1.10-26.x86_64.rpm\nlibdaemon-0.10-5.el5.i386.rpm\nlibdaemon-0.10-5.el5.x86_64.rpm\nlibdrm-2.0.2-1.1.i386.rpm\nlibdrm-2.0.2-1.1.x86_64.rpm\nlibevent-1.4.13-1.x86_64.rpm\nlibgcc-4.1.2-48.el5.i386.rpm\nlibgcc-4.1.2-48.el5.x86_64.rpm\nlibgcrypt-1.4.4-5.el5.i386.rpm\nlibgcrypt-1.4.4-5.el5.x86_64.rpm\nlibgomp-4.4.0-6.el5.x86_64.rpm\nlibgpg-error-1.4-2.i386.rpm\nlibgpg-error-1.4-2.x86_64.rpm\nlibgssapi-0.10-2.x86_64.rpm\nlibhugetlbfs-1.3-7.el5.i386.rpm\nlibhugetlbfs-1.3-7.el5.x86_64.rpm\nlibidn-0.6.5-1.1.x86_64.rpm\nlibjpeg-6b-37.x86_64.rpm\nlibnotify-0.4.2-6.el5.x86_64.rpm\nlibpcap-0.9.4-15.el5.x86_64.rpm\nlibpng-1.2.10-7.1.el5_3.2.x86_64.rpm\nlibselinux-1.33.4-5.5.el5.i386.rpm\nlibselinux-1.33.4-5.5.el5.x86_64.rpm\nlibselinux-python-1.33.4-5.5.el5.x86_64.rpm\nlibselinux-utils-1.33.4-5.5.el5.x86_64.rpm\nlibsemanage-1.9.1-4.4.el5.x86_64.rpm\nlibsepol-1.15.2-3.el5.i386.rpm\nlibsepol-1.15.2-3.el5.x86_64.rpm\nlibstdc++-4.1.2-48.el5.i386.rpm\nlibstdc++-4.1.2-48.el5.x86_64.rpm\nlibsysfs-2.0.0-6.x86_64.rpm\nlibtermcap-2.0.8-46.1.i386.rpm\nlibtermcap-2.0.8-46.1.x86_64.rpm\nlibtiff-3.8.2-7.el5_3.4.x86_64.rpm\nlibusb-0.1.12-5.1.i386.rpm\nlibusb-0.1.12-5.1.x86_64.rpm\nlibuser-0.54.7-2.1.el5_4.1.x86_64.rpm\nlibutempter-1.1.4-4.el5.i386.rpm\nlibutempter-1.1.4-4.el5.x86_64.rpm\nlibvolume_id-095-14.21.el5.i386.rpm\nlibvolume_id-095-14.21.el5.x86_64.rpm\nlibwnck-2.16.0-4.fc6.x86_64.rpm\nlibxml2-2.6.26-2.1.2.8.x86_64.rpm\nlibxml2-python-2.6.26-2.1.2.8.x86_64.rpm\nlm_sensors-2.10.7-9.el5.x86_64.rpm\nlogrotate-3.7.4-9.x86_64.rpm\nlsof-4.78-3.x86_64.rpm\nlvm2-2.02.56-8.el5_5.1.x86_64.rpm\nlzo2-2.02-3.el5.rf.x86_64.rpm\nm2crypto-0.16-6.el5.6.x86_64.rpm\nm4-1.4.5-3.el5.1.x86_64.rpm\nmailcap-2.1.23-1.fc6.noarch.rpm\nmailx-8.1.1-44.2.2.x86_64.rpm\nmake-3.81-3.el5.x86_64.rpm\nman-1.6d-1.1.x86_64.rpm\nman-pages-2.39-15.el5.noarch.rpm\nmcelog-0.9pre-1.29.el5.x86_64.rpm\nmcstrans-0.2.11-3.el5.x86_64.rpm\nmdadm-2.6.9-3.el5.x86_64.rpm\nmesa-libGL-6.5.1-7.8.el5.i386.rpm\nmesa-libGL-6.5.1-7.8.el5.x86_64.rpm\nmgetty-1.1.33-9.fc6.x86_64.rpm\nmicrocode_ctl-1.17-1.50.el5.x86_64.rpm\nmingetty-1.07-5.2.2.x86_64.rpm\nmkbootdisk-1.5.3-2.1.x86_64.rpm\nmkinitrd-5.1.19.6-61.el5_5.1.i386.rpm\nmkinitrd-5.1.19.6-61.el5_5.1.x86_64.rpm\nmktemp-1.5-23.2.2.x86_64.rpm\nmlocate-0.15-1.el5.2.x86_64.rpm\nmodule-init-tools-3.3-0.pre3.1.60.el5.x86_64.rpm\nmozldap-6.0.5-1.el5.x86_64.rpm\nmtools-3.9.10-2.fc6.x86_64.rpm\nmtr-0.75-1.el5.rf.x86_64.rpm\nmysql-5.0.77-4.el5_4.2.i386.rpm\nmysql-5.0.77-4.el5_4.2.x86_64.rpm\nmysql-server-5.0.77-4.el5_4.2.x86_64.rpm\nnagios-nrpe-2.12-1.el5.rf.x86_64.rpm\nnagios-plugins-1.4.14-1.el5.rf.x86_64.rpm\nnano-1.3.12-1.1.x86_64.rpm\nnash-5.1.19.6-61.el5_5.1.x86_64.rpm\nnc-1.84-10.fc6.x86_64.rpm\nncurses-5.5-24.20060715.i386.rpm\nncurses-5.5-24.20060715.x86_64.rpm\nnet-snmp-5.3.2.2-9.el5_5.1.x86_64.rpm\nnet-snmp-libs-5.3.2.2-9.el5_5.1.x86_64.rpm\nnet-tools-1.60-81.el5.x86_64.rpm\nnewt-0.52.2-15.el5.x86_64.rpm\nnfs-utils-1.0.9-44.el5.x86_64.rpm\nnfs-utils-lib-1.0.8-7.6.el5.x86_64.rpm\nnmap-5.00-1.el5.rf.x86_64.rpm\nnotification-daemon-0.3.5-9.el5.x86_64.rpm\nnscd-2.5-49.x86_64.rpm\nnspr-4.8.4-1.el5_4.i386.rpm\nnspr-4.8.4-1.el5_4.x86_64.rpm\nnss-3.12.6-1.el5_4.i386.rpm\nnss-3.12.6-1.el5_4.x86_64.rpm\nnss-tools-3.12.6-1.el5_4.x86_64.rpm\nnss_db-2.2-35.4.el5_5.i386.rpm\nnss_db-2.2-35.4.el5_5.x86_64.rpm\nnss_ldap-253-25.el5.i386.rpm\nnss_ldap-253-25.el5.x86_64.rpm\nntp-4.2.2p1-9.el5_4.1.x86_64.rpm\nntsysv-1.3.30.2-2.el5.x86_64.rpm\nnumactl-0.9.8-11.el5.i386.rpm\nnumactl-0.9.8-11.el5.x86_64.rpm\nopenldap-2.3.43-12.el5.i386.rpm\nopenldap-2.3.43-12.el5.x86_64.rpm\nopenldap-clients-2.3.43-12.el5.x86_64.rpm\nopenssh-4.3p2-41.el5.x86_64.rpm\nopenssh-clients-4.3p2-41.el5.x86_64.rpm\nopenssh-server-4.3p2-41.el5.x86_64.rpm\nopenssl-0.9.8e-12.el5_4.6.i686.rpm\nopenssl-0.9.8e-12.el5_4.6.x86_64.rpm\nopenvpn-2.0.9-1.el5.rf.x86_64.rpm\npam-0.99.6.2-6.el5_4.1.i386.rpm\npam-0.99.6.2-6.el5_4.1.x86_64.rpm\npam_ccreds-3-5.i386.rpm\npam_ccreds-3-5.x86_64.rpm\npam_krb5-2.2.14-15.i386.rpm\npam_krb5-2.2.14-15.x86_64.rpm\npam_passwdqc-1.0.2-1.2.2.i386.rpm\npam_passwdqc-1.0.2-1.2.2.x86_64.rpm\npam_pkcs11-0.5.3-23.i386.rpm\npam_pkcs11-0.5.3-23.x86_64.rpm\npam_smb-1.1.7-7.2.1.i386.rpm\npam_smb-1.1.7-7.2.1.x86_64.rpm\npango-1.14.9-8.el5.x86_64.rpm\npaps-0.6.6-19.el5.x86_64.rpm\nparted-1.8.1-27.el5.i386.rpm\nparted-1.8.1-27.el5.x86_64.rpm\npasswd-0.73-1.x86_64.rpm\npatch-2.5.4-29.2.3.el5.x86_64.rpm\npax-3.4-2.el5.x86_64.rpm\npciutils-2.2.3-8.el5.x86_64.rpm\npcmciautils-014-5.x86_64.rpm\npcre-6.6-2.el5_1.7.x86_64.rpm\npcsc-lite-1.4.4-1.el5.x86_64.rpm\npcsc-lite-libs-1.4.4-1.el5.x86_64.rpm\nperl-5.8.8-27.el5.x86_64.rpm\nperl-Crypt-DES-2.05-3.2.el5.rf.x86_64.rpm\nperl-Crypt-PasswdMD5-1.3-1.2.el5.rf.noarch.rpm\nperl-DBD-mysql-4.014-1.el5.rf.x86_64.rpm\nperl-DBI-1.609-1.el5.rf.x86_64.rpm\nperl-Digest-HMAC-1.01-15.noarch.rpm\nperl-Digest-SHA1-2.12-2.el5.rf.x86_64.rpm\nperl-Git-1.7.1-1.x86_64.rpm\nperl-Net-Daemon-0.43-1.el5.rf.noarch.rpm\nperl-Net-SNMP-5.2.0-1.2.el5.rf.noarch.rpm\nperl-PlRPC-0.2020-1.el5.rf.noarch.rpm\nperl-Socket6-0.23-1.el5.rf.x86_64.rpm\nperl-String-CRC32-1.4-2.fc6.x86_64.rpm\npinfo-0.6.9-1.fc6.x86_64.rpm\npkinit-nss-0.7.6-1.el5.x86_64.rpm\npm-utils-0.99.3-10.el5.x86_64.rpm\npolicycoreutils-1.33.12-14.8.el5.x86_64.rpm\npoppler-0.5.4-4.4.el5_4.11.x86_64.rpm\npoppler-utils-0.5.4-4.4.el5_4.11.x86_64.rpm\npopt-1.10.2.3-18.el5.x86_64.rpm\nportmap-4.0-65.2.2.1.x86_64.rpm\npostgresql-libs-8.1.21-1.el5_5.1.x86_64.rpm\nppp-2.4.4-2.el5.x86_64.rpm\nprelink-0.4.0-2.el5.x86_64.rpm\nprocmail-3.22-17.1.x86_64.rpm\nprocps-3.2.7-16.el5.x86_64.rpm\npsacct-6.3.2-44.el5.x86_64.rpm\npsmisc-22.2-7.x86_64.rpm\npuppet-0.25.4-1.rhel5.x86_64.rpm\npyOpenSSL-0.6-1.p24.7.2.2.x86_64.rpm\npygobject2-2.12.1-5.el5.x86_64.rpm\npython-2.4.3-27.el5.x86_64.rpm\npython-dmidecode-3.10.8-4.el5.x86_64.rpm\npython-elementtree-1.2.6-5.x86_64.rpm\npython-iniparse-0.2.3-4.el5.noarch.rpm\npython-sqlite-1.1.7-1.2.1.x86_64.rpm\npython-urlgrabber-3.1.0-5.el5.noarch.rpm\npython26-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\npython26-devel-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\npython26-libs-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\npython26-setuptools-0.6c7-1.rhel5.noarch.rpm\npython26-test-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\npython26-tools-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\nquota-3.13-1.2.5.el5.x86_64.rpm\nrdate-1.4-8.el5.x86_64.rpm\nrdist-6.1.5-44.x86_64.rpm\nreadahead-1.3-8.el5.x86_64.rpm\nreadline-5.1-3.el5.i386.rpm\nreadline-5.1-3.el5.x86_64.rpm\nredhat-logos-4.9.16-1.noarch.rpm\nredhat-lsb-3.1-12.3.EL.i386.rpm\nredhat-lsb-3.1-12.3.EL.x86_64.rpm\nredhat-menus-6.7.8-3.el5.noarch.rpm\nredhat-release-5Server-5.5.0.2.x86_64.rpm\nredhat-release-notes-5Server-31.x86_64.rpm\nrhel-instnum-1.0.9-1.el5.noarch.rpm\nrhn-check-0.4.20-33.el5_5.1.noarch.rpm\nrhn-client-tools-0.4.20-33.el5_5.1.noarch.rpm\nrhn-setup-0.4.20-33.el5_5.1.noarch.rpm\nrhnlib-2.5.22-3.el5.noarch.rpm\nrhnsd-4.7.0-5.el5.x86_64.rpm\nrhpl-0.194.1-1.x86_64.rpm\nrmt-0.4b41-4.el5.x86_64.rpm\nrng-utils-2.0-1.14.1.fc6.x86_64.rpm\nrootfiles-8.1-1.1.1.noarch.rpm\nrp-pppoe-3.5-32.1.x86_64.rpm\nrpm-4.4.2.3-18.el5.x86_64.rpm\nrpm-libs-4.4.2.3-18.el5.x86_64.rpm\nrpm-python-4.4.2.3-18.el5.x86_64.rpm\nrsh-0.17-40.el5.x86_64.rpm\nrsync-3.0.7-1.el5.rf.x86_64.rpm\nruby-1.8.5-5.el5_4.8.x86_64.rpm\nruby-augeas-0.3.0-1.el5.x86_64.rpm\nruby-irb-1.8.5-5.el5_4.8.x86_64.rpm\nruby-libs-1.8.5-5.el5_4.8.x86_64.rpm\nruby-rdoc-1.8.5-5.el5_4.8.x86_64.rpm\nscreen-4.0.3-1.el5_4.1.x86_64.rpm\nsed-4.1.5-5.fc6.x86_64.rpm\nselinux-policy-2.4.6-279.el5.noarch.rpm\nselinux-policy-targeted-2.4.6-279.el5.noarch.rpm\nsendmail-8.13.8-8.el5.x86_64.rpm\nsetarch-2.0-1.1.x86_64.rpm\nsetools-3.0-3.el5.x86_64.rpm\nsetserial-2.17-19.2.2.x86_64.rpm\nsetup-2.5.58-7.el5.noarch.rpm\nsetuptool-1.19.2-1.x86_64.rpm\nsgpio-1.2.0_10-2.el5.x86_64.rpm\nshadow-utils-4.0.17-15.el5.x86_64.rpm\nslang-2.0.6-4.el5.x86_64.rpm\nsmartmontools-5.38-2.el5.x86_64.rpm\nsos-1.7-9.49.el5.noarch.rpm\nspecspo-13-1.el5.noarch.rpm\nsqlite-3.3.6-5.x86_64.rpm\nstartup-notification-0.8-4.1.x86_64.rpm\nstrace-4.5.18-5.el5_4.4.x86_64.rpm\nstunnel-4.15-2.el5.1.x86_64.rpm\nsudo-1.7.2p1-6.el5_5.x86_64.rpm\nsvrcore-4.0.4-3.el5.i386.rpm\nsvrcore-4.0.4-3.el5.x86_64.rpm\nsymlinks-1.2-24.2.2.x86_64.rpm\nsysfsutils-2.0.0-6.x86_64.rpm\nsysklogd-1.4.1-46.el5.x86_64.rpm\nsyslinux-3.86-1.el5.rf.x86_64.rpm\nsysstat-7.0.2-3.el5.x86_64.rpm\nsystem-config-network-tui-1.3.99.18-1.el5.noarch.rpm\nsystem-config-securitylevel-tui-1.6.29.1-5.el5.x86_64.rpm\ntalk-0.17-29.2.2.x86_64.rpm\ntar-1.15.1-30.el5.x86_64.rpm\ntcl-8.4.13-4.el5.x86_64.rpm\ntcp_wrappers-7.6-40.7.el5.i386.rpm\ntcp_wrappers-7.6-40.7.el5.x86_64.rpm\ntcpdump-3.9.4-15.el5.x86_64.rpm\ntcsh-6.14-17.el5.x86_64.rpm\ntelnet-0.17-39.el5.x86_64.rpm\ntermcap-5.5-1.20060701.1.noarch.rpm\ntime-1.7-27.2.2.x86_64.rpm\ntix-8.4.0-11.fc6.x86_64.rpm\ntk-8.4.13-5.el5_1.1.x86_64.rpm\ntkinter26-2.6.2-geekymedia1.1.rhel5.x86_64.rpm\ntmpwatch-2.9.7-1.1.el5.2.x86_64.rpm\ntraceroute-2.0.1-5.el5.x86_64.rpm\ntree-1.5.0-4.x86_64.rpm\ntzdata-2010i-1.el5.x86_64.rpm\nudev-095-14.21.el5.x86_64.rpm\nudftools-1.0.0b3-3.el5.rf.x86_64.rpm\nunix2dos-2.2-26.2.3.el5.x86_64.rpm\nunzip-5.52-3.el5.x86_64.rpm\nusbutils-0.71-2.1.x86_64.rpm\nusermode-1.88-3.el5.2.x86_64.rpm\nutil-linux-2.13-0.52.el5_4.1.x86_64.rpm\nvconfig-1.9-3.x86_64.rpm\nvim-common-7.0.109-6.el5.x86_64.rpm\nvim-enhanced-7.0.109-6.el5.x86_64.rpm\nvim-minimal-7.0.109-6.el5.x86_64.rpm\nvixie-cron-4.1-77.el5_4.1.x86_64.rpm\nvmware-update-manager-ga-1.0.0-84689.i386.rpm\nwget-1.11.4-2.el5_4.1.x86_64.rpm\nwhich-2.16-7.x86_64.rpm\nwireless-tools-28-2.el5.i386.rpm\nwireless-tools-28-2.el5.x86_64.rpm\nwords-3.0-9.1.noarch.rpm\nwpa_supplicant-0.5.10-9.el5.x86_64.rpm\nxorg-x11-filesystem-7.1-2.fc6.noarch.rpm\nyp-tools-2.9-1.el5.x86_64.rpm\nypbind-1.19-12.el5.x86_64.rpm\nyum-3.2.22-26.el5.noarch.rpm\nyum-metadata-parser-1.1.2-3.el5.x86_64.rpm\nyum-rhn-plugin-0.5.4-15.el5.noarch.rpm\nyum-security-1.1.16-13.el5.noarch.rpm\nyum-updatesd-0.9-2.el5.noarch.rpm\nyum-utils-1.1.16-13.el5.noarch.rpm\nzip-2.31-2.el5.x86_64.rpm\nzlib-1.2.3-3.i386.rpm\nzlib-1.2.3-3.x86_64.rpm'}

sshconfig_dict = {'SyslogFacility': 'AUTHPRIV',
'PasswordAuthentication': 'no',
'ChallengeResponseAuthentication': 'high low medium',
'GSSAPIAuthentication': 'yes'}


ipt_dict = {'status': 0, 'rules': {'body': '*nat\n:PREROUTING ACCEPT\n:POSTROUTING ACCEPT\n:OUTPUT ACCEPT\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.8.0/255.255.252.0 -o bond0.6 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.80.0/255.255.255.0 -o bond0.80 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.75.0/255.255.255.0 -o bond0.75 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 63.245.209.4 -o bond0 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 63.245.209.7 -o bond0 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.74.0/255.255.255.0 -o bond0.74 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.72.0/255.255.255.0 -o bond0.72 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.81.0/255.255.255.0 -o bond0.81 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.50.0/255.255.255.0 -o bond0.50 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.70.0/255.255.255.0 -o bond0.70 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.71.0/255.255.255.0 -o bond0.71 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.73.0/255.255.255.0 -o bond0.73 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.76.0/255.255.255.0 -o bond0.76 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.253.0.0/255.255.255.0 -o bond0.60 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.32.0/255.255.240.0 -o bond0.24 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.110.0/255.255.255.0 -o bond0.110 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.82.0/255.255.255.0 -o bond0.82 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.83.0/255.255.255.0 -o bond0.83 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.84.0/255.255.255.0 -o bond0.84 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.2.90.0/255.255.254.0 -o bond0.90 -j MASQUERADE\n-A POSTROUTING -s 10.2.20.0/255.255.255.0 -d 10.110.0.0/255.255.0.0 -j MASQUERADE\nCOMMIT\n*filter\n:INPUT ACCEPT\n:FORWARD ACCEPT\n:OUTPUT ACCEPT\n:DROP-LOG -\n:IN-ICMP -\n:IN-INFRASTRUCTURE -\n:IN-OUTSIDE -\n:INSIDE-NETS -\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -d 63.245.208.5 -i bond0 -p icmp -j IN-ICMP\n-A INPUT -s 63.245.208.0/255.255.254.0 -d 63.245.208.5 -i bond0 -m state --state NEW -j IN-INFRASTRUCTURE\n-A INPUT -s 63.245.212.0/255.255.254.0 -d 63.245.208.5 -i bond0 -m state --state NEW -j IN-INFRASTRUCTURE\n-A INPUT -s 10.0.0.0/255.0.0.0 -m state --state NEW -j INSIDE-NETS\n-A INPUT -d 63.245.208.5 -i bond0 -m state --state NEW -j IN-OUTSIDE\n-A INPUT -i bond0 -j DROP-LOG\n-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -i bond0 -j DROP-LOG\n-A FORWARD -d 10.2.10.5 -o bond0.6 -m state --state NEW -j ACCEPT\n-A FORWARD -d 10.2.80.5 -o bond0.80 -m state --state NEW -j ACCEPT\n-A FORWARD -d 10.2.75.5 -o bond0.75 -m state --state NEW -j ACCEPT\n-A FORWARD -d 10.2.72.5 -o bond0.72 -m state --state NEW -j ACCEPT\n-A FORWARD -d 10.2.81.5 -o bond0.81 -m state --state NEW -j ACCEPT\n-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A OUTPUT -d 10.2.10.5 -o bond0.6 -m state --state NEW -j ACCEPT\n-A OUTPUT -d 10.2.80.5 -o bond0.80 -m state --state NEW -j ACCEPT\n-A OUTPUT -d 10.2.75.5 -o bond0.75 -m state --state NEW -j ACCEPT\n-A OUTPUT -d 10.2.72.5 -o bond0.72 -m state --state NEW -j ACCEPT\n-A OUTPUT -d 10.2.71.5 -o bond0.71 -m state --state NEW -j ACCEPT\n-A OUTPUT -d 10.2.81.5 -o bond0.81 -m state --state NEW -j ACCEPT\n-A DROP-LOG -j LOG --log-prefix "bond0 DENY " --log-level 6\n-A DROP-LOG -j DROP\n-A IN-ICMP -p icmp -m icmp --icmp-type 11/0 -j ACCEPT\n-A IN-ICMP -p icmp -m icmp --icmp-type 11/1 -j ACCEPT\n-A IN-ICMP -p icmp -m icmp --icmp-type 0/0 -j ACCEPT\n-A IN-ICMP -p icmp -m icmp --icmp-type 3 -j ACCEPT\n-A IN-ICMP -p icmp -m icmp --icmp-type 8/0 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.208.32/255.255.255.240 -d 63.245.208.5 -p tcp -m tcp --dport 49 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.208.0/255.255.254.0 -d 63.245.208.5 -p udp -m udp -m multiport --dports 53,69,123,162,514 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.208.36/255.255.255.254 -d 63.245.208.5 -p udp -m udp -m multiport --dports 4444 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.208.11 -d 63.245.208.5 -p tcp -m tcp --dport 49 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.212.254 -d 63.245.208.5 -p tcp -m tcp --dport 49 -j ACCEPT\n-A IN-INFRASTRUCTURE -s 63.245.212.253 -d 63.245.208.5 -p tcp -m tcp --dport 49 -j ACCEPT\n-A IN-OUTSIDE -p tcp -m tcp -m multiport --dports 443,22 -j ACCEPT\n-A IN-OUTSIDE -p udp -m udp --dport 1194 -j ACCEPT\n-A IN-OUTSIDE -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INSIDE-NETS -s 10.2.20.0/255.255.255.0 -j ACCEPT\n-A INSIDE-NETS -s 10.2.8.0/255.255.252.0 -d 10.2.10.5 -j ACCEPT\n-A INSIDE-NETS -s 10.2.74.123 -d 10.2.10.5 -j ACCEPT\n-A INSIDE-NETS -s 10.2.72.4 -d 10.2.72.5 -j ACCEPT\n-A INSIDE-NETS -s 10.2.74.123 -d 10.2.74.5 -j ACCEPT\n-A INSIDE-NETS -s 10.2.75.110 -d 10.2.75.5 -j ACCEPT\n-A INSIDE-NETS -s 10.2.75.105 -d 10.2.75.5 -p tcp -m tcp --dport 22 -j ACCEPT\n-A INSIDE-NETS -s 10.2.72.11 -d 10.2.72.5 -p tcp -m tcp --dport 80 -j ACCEPT\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -p tcp -m tcp --dport 53 -j ACCEPT\n-A INSIDE-NETS -s 10.0.0.0/255.0.0.0 -p udp -m udp --sport 67:68 --dport 67:68 -j ACCEPT\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -p udp -m udp -m multiport --dports 53,123 -j ACCEPT\n-A INSIDE-NETS -s 10.253.0.0/255.255.0.0 -p tcp -m tcp --dport 25 -j ACCEPT\n-A INSIDE-NETS -s 10.2.32.0/255.255.240.0 -j ACCEPT\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -p udp -m udp --dport 137:138 -j DROP\n-A INSIDE-NETS -s 10.2.80.0/255.255.254.0 -p tcp -m tcp --dport 80 -j DROP\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -p tcp -m tcp --sport 137 --dport 137 -j DROP\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -j LOG --log-prefix "inside DENY " --log-level 6\n-A INSIDE-NETS -s 10.2.0.0/255.255.0.0 -j DROP\nCOMMIT\n'}}

acl_list = [{'body': 'ServerTokens Prod\nServerRoot "/etc/httpd"\nPidFile run/httpd.pid\nTimeout 120\nKeepAlive On\nMaxKeepAliveRequests 1000\nKeepAliveTimeout 5\n<IfModule prefork.c>\nStartServers      200\nMinSpareServers   10\nMaxSpareServers   50\nServerLimit     260\nMaxClients      260\nMaxRequestsPerChild  500\n</IfModule>\n<IfModule worker.c>\nStartServers         2\nMaxClients         260\nMinSpareThreads     25\nMaxSpareThreads     75 \nThreadsPerChild     25\nMaxRequestsPerChild  0\n</IfModule>\nListen 80\nListen 81\nLoadModule auth_basic_module modules/mod_auth_basic.so\nLoadModule authn_file_module modules/mod_authn_file.so\nLoadModule auth_digest_module modules/mod_auth_digest.so\nLoadModule authz_host_module modules/mod_authz_host.so\nLoadModule authz_default_module modules/mod_authz_default.so\nLoadModule authz_user_module modules/mod_authz_user.so\nLoadModule ldap_module modules/mod_ldap.so\nLoadModule authnz_ldap_module modules/mod_authnz_ldap.so\nLoadModule include_module modules/mod_include.so\nLoadModule log_config_module modules/mod_log_config.so\nLoadModule env_module modules/mod_env.so\nLoadModule mime_magic_module modules/mod_mime_magic.so\nLoadModule cern_meta_module modules/mod_cern_meta.so\nLoadModule expires_module modules/mod_expires.so\nLoadModule deflate_module modules/mod_deflate.so\nLoadModule headers_module modules/mod_headers.so\nLoadModule usertrack_module modules/mod_usertrack.so\nLoadModule setenvif_module modules/mod_setenvif.so\nLoadModule mime_module modules/mod_mime.so\nLoadModule dav_module modules/mod_dav.so\nLoadModule status_module modules/mod_status.so\nLoadModule autoindex_module modules/mod_autoindex.so\nLoadModule asis_module modules/mod_asis.so\nLoadModule info_module modules/mod_info.so\nLoadModule dav_fs_module modules/mod_dav_fs.so\nLoadModule vhost_alias_module modules/mod_vhost_alias.so\nLoadModule negotiation_module modules/mod_negotiation.so\nLoadModule dir_module modules/mod_dir.so\nLoadModule actions_module modules/mod_actions.so\nLoadModule speling_module modules/mod_speling.so\nLoadModule userdir_module modules/mod_userdir.so\nLoadModule alias_module modules/mod_alias.so\nLoadModule rewrite_module modules/mod_rewrite.so\nLoadModule proxy_module modules/mod_proxy.so\nLoadModule proxy_ftp_module modules/mod_proxy_ftp.so\nLoadModule proxy_http_module modules/mod_proxy_http.so\nLoadModule proxy_connect_module modules/mod_proxy_connect.so\nLoadModule cache_module modules/mod_cache.so\nLoadModule suexec_module modules/mod_suexec.so\nLoadModule disk_cache_module modules/mod_disk_cache.so\nLoadModule file_cache_module modules/mod_file_cache.so\nLoadModule mem_cache_module modules/mod_mem_cache.so\nLoadModule cgi_module modules/mod_cgi.so\nLoadModule log_forensic_module modules/mod_log_forensic.so\nInclude conf.d/*.conf\nExtendedStatus On\nUser apache\nGroup apache\nServerAdmin webmaster@mozilla.com\nUseCanonicalName Off\nDocumentRoot "/var/www/html/"\n<Directory />\n    Options FollowSymLinks\n    AllowOverride None\n</Directory>\n<Directory "/var/www/html">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n<IfModule mod_userdir.c>\n    UserDir disable\n</IfModule>\nDirectoryIndex index.html index.html.var\nAccessFileName .htaccess\n<Files ~ "^\\.ht">\n    Order allow,deny\n    Deny from all\n</Files>\n<DirectoryMatch "\\.svn/">\n    Order allow,deny\n    Deny from all\n</DirectoryMatch>\nTypesConfig /etc/mime.types\nDefaultType text/plain\n<IfModule mod_mime_magic.c>\n    MIMEMagicFile conf/magic\n</IfModule>\nHostnameLookups Off\nErrorLog "|/data/bin/multi_logger.pl general \'/var/log/httpd/error_log 86400 -0\'"\nLogLevel error\nLogFormat "%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined\nLogFormat "%h %l %u %t \\"%r\\" %>s %b" common\nLogFormat "%{Referer}i -> %U" referer\nLogFormat "%{User-agent}i" agent\nCustomLog logs/access_log combined\nServerSignature Off\nAlias /icons/ "/var/www/icons/"\n<Directory "/var/www/icons">\n    Options Indexes MultiViews\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n</Directory>\n<IfModule mod_dav_fs.c>\n    DAVLockDB /var/lib/dav/lockdb\n</IfModule>\nScriptAlias /cgi-bin/ "/var/www/cgi-bin/"\n<Directory "/var/www/cgi-bin">\n    AllowOverride None\n    Options None\n    Order allow,deny\n    Allow from all\n</Directory>\nIndexOptions FancyIndexing VersionSort NameWidth=*\nAddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip\nAddIconByType (TXT,/icons/text.gif) text/*\nAddIconByType (IMG,/icons/image2.gif) image/*\nAddIconByType (SND,/icons/sound2.gif) audio/*\nAddIconByType (VID,/icons/movie.gif) video/*\nAddIcon /icons/binary.gif .bin .exe\nAddIcon /icons/binhex.gif .hqx\nAddIcon /icons/tar.gif .tar\nAddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv\nAddIcon /icons/compressed.gif .Z .z .tgz .gz .zip\nAddIcon /icons/a.gif .ps .ai .eps\nAddIcon /icons/layout.gif .html .shtml .htm .pdf\nAddIcon /icons/text.gif .txt\nAddIcon /icons/c.gif .c\nAddIcon /icons/p.gif .pl .py\nAddIcon /icons/f.gif .for\nAddIcon /icons/dvi.gif .dvi\nAddIcon /icons/uuencoded.gif .uu\nAddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl\nAddIcon /icons/tex.gif .tex\nAddIcon /icons/bomb.gif core\nAddIcon /icons/back.gif ..\nAddIcon /icons/hand.right.gif README\nAddIcon /icons/folder.gif ^^DIRECTORY^^\nAddIcon /icons/blank.gif ^^BLANKICON^^\nDefaultIcon /icons/unknown.gif\nReadmeName README.html\nHeaderName HEADER.html\nIndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t\nAddLanguage ca .ca\nAddLanguage cs .cz .cs\nAddLanguage da .dk\nAddLanguage de .de\nAddLanguage el .el\nAddLanguage en .en\nAddLanguage eo .eo\nAddLanguage es .es\nAddLanguage et .et\nAddLanguage fr .fr\nAddLanguage he .he\nAddLanguage hr .hr\nAddLanguage it .it\nAddLanguage ja .ja\nAddLanguage ko .ko\nAddLanguage ltz .ltz\nAddLanguage nl .nl\nAddLanguage nn .nn\nAddLanguage no .no\nAddLanguage pl .po\nAddLanguage pt .pt\nAddLanguage pt-BR .pt-br\nAddLanguage ru .ru\nAddLanguage sv .sv\nAddLanguage zh-CN .zh-cn\nAddLanguage zh-TW .zh-tw\nLanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW\nForceLanguagePriority Prefer Fallback\nAddDefaultCharset UTF-8\nAddCharset ISO-8859-1  .iso8859-1  .latin1\nAddCharset ISO-8859-2  .iso8859-2  .latin2 .cen\nAddCharset ISO-8859-3  .iso8859-3  .latin3\nAddCharset ISO-8859-4  .iso8859-4  .latin4\nAddCharset ISO-8859-5  .iso8859-5  .latin5 .cyr .iso-ru\nAddCharset ISO-8859-6  .iso8859-6  .latin6 .arb\nAddCharset ISO-8859-7  .iso8859-7  .latin7 .grk\nAddCharset ISO-8859-8  .iso8859-8  .latin8 .heb\nAddCharset ISO-8859-9  .iso8859-9  .latin9 .trk\nAddCharset ISO-2022-JP .iso2022-jp .jis\nAddCharset ISO-2022-KR .iso2022-kr .kis\nAddCharset ISO-2022-CN .iso2022-cn .cis\nAddCharset Big5        .Big5       .big5\nAddCharset WINDOWS-1251 .cp-1251   .win-1251\nAddCharset CP866       .cp866\nAddCharset KOI8-r      .koi8-r .koi8-ru\nAddCharset KOI8-ru     .koi8-uk .ua\nAddCharset ISO-10646-UCS-2 .ucs2\nAddCharset ISO-10646-UCS-4 .ucs4\nAddCharset UTF-8       .utf8\nAddCharset GB2312      .gb2312 .gb \nAddCharset utf-7       .utf7\nAddCharset utf-8       .utf8\nAddCharset big5        .big5 .b5\nAddCharset EUC-TW      .euc-tw\nAddCharset EUC-JP      .euc-jp\nAddCharset EUC-KR      .euc-kr\nAddCharset shift_jis   .sjis\nAddType application/x-xpinstall .xpi\nAddType image/png .png\nAddType image/x-icon .ico\nAddType application/x-compress .Z\nAddType application/x-gzip .gz .tgz\nAddType x-java-archive .jar\nAddHandler imap-file map\nAddHandler type-map var\nAddType text/html .shtml\nAddOutputFilter INCLUDES .shtml\nAlias /error/ "/var/www/error/"\n<IfModule mod_negotiation.c>\n<IfModule mod_include.c>\n    <Directory "/var/www/error">\n        AllowOverride None\n        Options IncludesNoExec\n        AddOutputFilter Includes html\n        AddHandler type-map var\n        Order allow,deny\n        Allow from all\n        LanguagePriority en es de fr\n        ForceLanguagePriority Prefer Fallback\n    </Directory>\n</IfModule>\n</IfModule>\nBrowserMatch "Mozilla/2" nokeepalive\nBrowserMatch "MSIE 4\\.0b2;" nokeepalive downgrade-1.0 force-response-1.0\nBrowserMatch "RealPlayer 4\\.0" force-response-1.0\nBrowserMatch "Java/1\\.0" force-response-1.0\nBrowserMatch "JDK/1\\.0" force-response-1.0\nBrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully\nBrowserMatch "^WebDrive" redirect-carefully\nBrowserMatch "^WebDAVFS/1.[012]" redirect-carefully\nBrowserMatch "^gnome-vfs" redirect-carefully\n<Location /server-status>\n    SetHandler server-status\n    Order deny,allow\n    Deny from all\n    Allow from 127.0.0.1\n    Allow from 10.2.74.123\n</Location>\nNameVirtualHost *:80\nNameVirtualHost *:81\n<VirtualHost _default_:80>\n    ServerAdmin webmaster@mozilla.org\n    DocumentRoot /data/www/default\n    RewriteEngine On\n    RewriteCond %{REQUEST_URI} !^/status.cgi$\n    RewriteCond %{REQUEST_URI} !^/server-status$\n    RewriteRule .* http://www.mozilla.com/ [R]\n    <Directory /data/www/default>\n        Options ExecCGI\n        AddHandler cgi-script .cgi\n    </Directory>\n    <Location /server-status>\n    SetHandler server-status\n    Order deny,allow\n    Deny from all\n    Allow from 127.0.0.1\n    Allow from 10.2.81.5\n    Allow from 10.2.74.123\n    </Location>\n</VirtualHost>\nFileETag Size\nCoreDumpDirectory /tmp\ninclude conf/domains/addons.mozilla.org.remora.conf\ninclude conf/domains/pfs.conf\ninclude conf/domains/pfs2.mozilla.org.conf\n', 'domains': {}, 'directives': {'Group': ['apache'], 'Timeout': ['120'], 'ReadmeName': ['README.html'], 'AddCharset': ['ISO-8859-1 .iso8859-1 .latin1', 'ISO-8859-2 .iso8859-2 .latin2 .cen', 'ISO-8859-3 .iso8859-3 .latin3', 'ISO-8859-4 .iso8859-4 .latin4', 'ISO-8859-5 .iso8859-5 .latin5 .cyr .iso-ru', 'ISO-8859-6 .iso8859-6 .latin6 .arb', 'ISO-8859-7 .iso8859-7 .latin7 .grk', 'ISO-8859-8 .iso8859-8 .latin8 .heb', 'ISO-8859-9 .iso8859-9 .latin9 .trk', 'ISO-2022-JP .iso2022-jp .jis', 'ISO-2022-KR .iso2022-kr .kis', 'ISO-2022-CN .iso2022-cn .cis', 'Big5 .Big5 .big5', 'WINDOWS-1251 .cp-1251 .win-1251', 'CP866 .cp866', 'KOI8-r .koi8-r .koi8-ru', 'KOI8-ru .koi8-uk .ua', 'ISO-10646-UCS-2 .ucs2', 'ISO-10646-UCS-4 .ucs4', 'UTF-8 .utf8', 'GB2312 .gb2312 .gb', 'utf-7 .utf7', 'utf-8 .utf8', 'big5 .big5 .b5', 'EUC-TW .euc-tw', 'EUC-JP .euc-jp', 'EUC-KR .euc-kr', 'shift_jis .sjis'], 'AddOutputFilter': ['INCLUDES .shtml', 'Includes html'], 'Deny': ['from all', 'from all', 'from all', 'from all'], 'StartServers': ['200', '2'], 'Directory': ['/', '"/var/www/html"', '"/var/www/icons"', '"/var/www/cgi-bin"', '"/var/www/error"', '/data/www/default'], 'ScriptAlias': ['/cgi-bin/ "/var/www/cgi-bin/"'], 'ThreadsPerChild': ['25'], 'DocumentRoot': ['"/var/www/html/"', '/data/www/default'], 'ServerAdmin': ['webmaster@mozilla.com', 'webmaster@mozilla.org'], 'Include': ['conf.d/*.conf'], 'AddLanguage': ['ca .ca', 'cs .cz .cs', 'da .dk', 'de .de', 'el .el', 'en .en', 'eo .eo', 'es .es', 'et .et', 'fr .fr', 'he .he', 'hr .hr', 'it .it', 'ja .ja', 'ko .ko', 'ltz .ltz', 'nl .nl', 'nn .nn', 'no .no', 'pl .po', 'pt .pt', 'pt-BR .pt-br', 'ru .ru', 'sv .sv', 'zh-CN .zh-cn', 'zh-TW .zh-tw'], 'FileETag': ['Size'], 'ExtendedStatus': ['On'], 'Files': ['~ "^\\.ht"'], 'MIMEMagicFile': ['conf/magic'], 'DefaultIcon': ['/icons/unknown.gif'], 'NameVirtualHost': ['*:80', '*:81'], 'DefaultType': ['text/plain'], 'ServerRoot': ['"/etc/httpd"'], 'MinSpareServers': ['10'], 'VirtualHost': ['_default_:80'], 'MinSpareThreads': ['25'], 'AllowOverride': ['None', 'None', 'None', 'None', 'None'], 'BrowserMatch': ['"Mozilla/2" nokeepalive', '"MSIE 4\\.0b2;" nokeepalive downgrade-1.0 force-response-1.0', '"RealPlayer 4\\.0" force-response-1.0', '"Java/1\\.0" force-response-1.0', '"JDK/1\\.0" force-response-1.0', '"Microsoft Data Access Internet Publishing Provider" redirect-carefully', '"^WebDrive" redirect-carefully', '"^WebDAVFS/1.[012]" redirect-carefully', '"^gnome-vfs" redirect-carefully'], 'include': ['conf/domains/addons.mozilla.org.remora.conf', 'conf/domains/pfs.conf', 'conf/domains/pfs2.mozilla.org.conf'], 'AddIcon': ['/icons/binary.gif .bin .exe', '/icons/binhex.gif .hqx', '/icons/tar.gif .tar', '/icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv', '/icons/compressed.gif .Z .z .tgz .gz .zip', '/icons/a.gif .ps .ai .eps', '/icons/layout.gif .html .shtml .htm .pdf', '/icons/text.gif .txt', '/icons/c.gif .c', '/icons/p.gif .pl .py', '/icons/f.gif .for', '/icons/dvi.gif .dvi', '/icons/uuencoded.gif .uu', '/icons/script.gif .conf .sh .shar .csh .ksh .tcl', '/icons/tex.gif .tex', '/icons/bomb.gif core', '/icons/back.gif ..', '/icons/hand.right.gif README', '/icons/folder.gif ^^DIRECTORY^^', '/icons/blank.gif ^^BLANKICON^^'], 'UserDir': ['disable'], 'HostnameLookups': ['Off'], 'MaxClients': ['260', '260'], 'User': ['apache'], 'LoadModule': ['auth_basic_module modules/mod_auth_basic.so', 'authn_file_module modules/mod_authn_file.so', 'auth_digest_module modules/mod_auth_digest.so', 'authz_host_module modules/mod_authz_host.so', 'authz_default_module modules/mod_authz_default.so', 'authz_user_module modules/mod_authz_user.so', 'ldap_module modules/mod_ldap.so', 'authnz_ldap_module modules/mod_authnz_ldap.so', 'include_module modules/mod_include.so', 'log_config_module modules/mod_log_config.so', 'env_module modules/mod_env.so', 'mime_magic_module modules/mod_mime_magic.so', 'cern_meta_module modules/mod_cern_meta.so', 'expires_module modules/mod_expires.so', 'deflate_module modules/mod_deflate.so', 'headers_module modules/mod_headers.so', 'usertrack_module modules/mod_usertrack.so', 'setenvif_module modules/mod_setenvif.so', 'mime_module modules/mod_mime.so', 'dav_module modules/mod_dav.so', 'status_module modules/mod_status.so', 'autoindex_module modules/mod_autoindex.so', 'asis_module modules/mod_asis.so', 'info_module modules/mod_info.so', 'dav_fs_module modules/mod_dav_fs.so', 'vhost_alias_module modules/mod_vhost_alias.so', 'negotiation_module modules/mod_negotiation.so', 'dir_module modules/mod_dir.so', 'actions_module modules/mod_actions.so', 'speling_module modules/mod_speling.so', 'userdir_module modules/mod_userdir.so', 'alias_module modules/mod_alias.so', 'rewrite_module modules/mod_rewrite.so', 'proxy_module modules/mod_proxy.so', 'proxy_ftp_module modules/mod_proxy_ftp.so', 'proxy_http_module modules/mod_proxy_http.so', 'proxy_connect_module modules/mod_proxy_connect.so', 'cache_module modules/mod_cache.so', 'suexec_module modules/mod_suexec.so', 'disk_cache_module modules/mod_disk_cache.so', 'file_cache_module modules/mod_file_cache.so', 'mem_cache_module modules/mod_mem_cache.so', 'cgi_module modules/mod_cgi.so', 'log_forensic_module modules/mod_log_forensic.so'], 'KeepAlive': ['On'], 'ServerSignature': ['Off'], 'SetHandler': ['server-status', 'server-status'], 'MaxSpareThreads': ['75'], 'UseCanonicalName': ['Off'], 'AddDefaultCharset': ['UTF-8'], 'DirectoryMatch': ['"\\.svn/"'], 'DAVLockDB': ['/var/lib/dav/lockdb'], 'Listen': ['80', '81'], 'ServerLimit': ['260'], 'LanguagePriority': ['en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW', 'en es de fr'], 'RewriteEngine': ['On'], 'AddHandler': ['imap-file map', 'type-map var', 'type-map var', 'cgi-script .cgi'], 'LogLevel': ['error'], 'HeaderName': ['HEADER.html'], 'Alias': ['/icons/ "/var/www/icons/"', '/error/ "/var/www/error/"'], 'Allow': ['from all', 'from all', 'from all', 'from all', 'from 127.0.0.1', 'from 10.2.74.123', 'from 127.0.0.1', 'from 10.2.81.5', 'from 10.2.74.123'], 'KeepAliveTimeout': ['5'], 'CustomLog': ['logs/access_log combined'], 'IndexOptions': ['FancyIndexing VersionSort NameWidth=*'], 'AccessFileName': ['.htaccess'], 'Order': ['allow,deny', 'allow,deny', 'allow,deny', 'allow,deny', 'allow,deny', 'allow,deny', 'deny,allow', 'deny,allow'], 'AddType': ['application/x-xpinstall .xpi', 'image/png .png', 'image/x-icon .ico', 'application/x-compress .Z', 'application/x-gzip .gz .tgz', 'x-java-archive .jar', 'text/html .shtml'], 'RewriteCond': ['%{REQUEST_URI} !^/status.cgi$', '%{REQUEST_URI} !^/server-status$'], 'RewriteRule': ['.* http://www.mozilla.com/ [R]'], 'AddIconByEncoding': ['(CMP,/icons/compressed.gif) x-compress x-gzip'], 'Options': ['FollowSymLinks', 'Indexes FollowSymLinks', 'Indexes MultiViews', 'None', 'IncludesNoExec', 'ExecCGI'], 'LogFormat': ['"%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined', '"%h %l %u %t \\"%r\\" %>s %b" common', '"%{Referer}i -> %U" referer', '"%{User-agent}i" agent'], 'MaxSpareServers': ['50'], 'ServerTokens': ['Prod'], 'CoreDumpDirectory': ['/tmp'], 'IfModule': ['prefork.c', 'worker.c', 'mod_userdir.c', 'mod_mime_magic.c', 'mod_dav_fs.c', 'mod_include.c', 'mod_negotiation.c'], 'ErrorLog': ['"|/data/bin/multi_logger.pl general \'/var/log/httpd/error_log 86400 -0\'"'], 'DirectoryIndex': ['index.html index.html.var'], 'IndexIgnore': ['.??* *~ *# HEADER* README* RCS CVS *,v *,t'], 'TypesConfig': ['/etc/mime.types'], 'MaxRequestsPerChild': ['500', '0'], 'MaxKeepAliveRequests': ['1000'], 'AddIconByType': ['(TXT,/icons/text.gif) text/*', '(IMG,/icons/image2.gif) image/*', '(SND,/icons/sound2.gif) audio/*', '(VID,/icons/movie.gif) video/*'], 'ForceLanguagePriority': ['Prefer Fallback', 'Prefer Fallback'], 'PidFile': ['run/httpd.pid'], 'Location': ['/server-status', '/server-status']}, 'included': ['/root/amo19_httpd/httpd/conf.d/python.conf', '/root/amo19_httpd/httpd/conf.d/welcome.conf', '/root/amo19_httpd/httpd/conf.d/php.conf', '/root/amo19_httpd/httpd/conf.d/perl.conf', '/root/amo19_httpd/httpd/conf.d/proxy_ajp.conf', '/root/amo19_httpd/httpd/conf/domains/addons.mozilla.org.remora.conf', '/root/amo19_httpd/httpd/conf/domains/pfs.conf', '/root/amo19_httpd/httpd/conf/domains/pfs2.mozilla.org.conf'], 'filename': '/root/amo19_httpd/httpd/conf/httpd.conf'}, {'body': 'LoadModule python_module modules/mod_python.so\n<Directory "/var/www/manual/mod/mod_python">\n    <Files *.html>\n        SetHandler default-handler\n    </Files>\n</Directory>\n', 'domains': {}, 'directives': {'Files': ['*.html'], 'Directory': ['"/var/www/manual/mod/mod_python"'], 'LoadModule': ['python_module modules/mod_python.so'], 'SetHandler': ['default-handler']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf.d/python.conf'}, {'body': '<LocationMatch "^/+$">\n    Options -Indexes\n    ErrorDocument 403 /error/noindex.html\n</LocationMatch>\n', 'domains': {}, 'directives': {'ErrorDocument': ['403 /error/noindex.html'], 'Options': ['-Indexes'], 'LocationMatch': ['"^/+$"']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf.d/welcome.conf'}, {'body': 'LoadModule php5_module modules/libphp5.so\n<FilesMatch \\.php$>\n    SetHandler php5-script\n</FilesMatch>  \nAddType text/html .php\nDirectoryIndex index.php\n', 'domains': {}, 'directives': {'FilesMatch': ['\\.php$'], 'LoadModule': ['php5_module modules/libphp5.so'], 'SetHandler': ['php5-script'], 'AddType': ['text/html .php'], 'DirectoryIndex': ['index.php']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf.d/php.conf'}, {'body': 'LoadModule perl_module modules/mod_perl.so\n', 'domains': {}, 'directives': {'LoadModule': ['perl_module modules/mod_perl.so']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf.d/perl.conf'}, {'body': 'LoadModule proxy_ajp_module modules/mod_proxy_ajp.so\n', 'domains': {}, 'directives': {'LoadModule': ['proxy_ajp_module modules/mod_proxy_ajp.so']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf.d/proxy_ajp.conf'}, {'body': '<VirtualHost *:80 *:81>\n    ServerName addons.mozilla.org\n    ServerAlias addons.update.mozilla.org addons-nl.stage.mozilla.com versioncheck.addons.mozilla.org\n    DocumentRoot /data/www/addons.mozilla.org-remora/site/app/webroot\n    SetEnv HTTPS on\n    RewriteEngine On\n    RewriteRule ^/favicon.ico$ /data/www/addons.mozilla.org-remora/site/app/webroot/img/favicon.ico [L]\n    RewriteRule ^/ja(?:-JP-mac)?/firefox/bookmarks[/]?$ https://addons.mozilla.jp/firefox/extensions/bookmarks_and_history/ [R=permanent,QSA,NE]\n    <Directory /data/www/addons.mozilla.org-remora>\n        Satisfy Any\n        AllowOverride All\n    </Directory>    \n    <Directory /data/www/addons.mozilla.org-remora/site/app/webroot/ebay/ebay-extension>\n        RewriteEngine On\n        RewriteBase /ebay/ebay-extension\n        AllowOverride None\n        RewriteRule ^$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L] \n        RewriteRule ^ebay-0.9.6.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.6.7.xpi [R,L]\n        RewriteRule ^ebay-0.9.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]\n    </Directory>\n    <Location /api>\n        Order Deny,Allow\n        Deny From All\n    </Location>\n    LogFormat "%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\""  custom\n    ErrorLog "|/data/bin/multi_logger.pl addons \'/var/log/httpd/addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"\n    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image\n</VirtualHost>\n<VirtualHost *:80>\n    ServerName services.addons.mozilla.org\n    Redirect / https://services.addons.mozilla.org/\n</VirtualHost>\n<VirtualHost *:81>\n    ServerName services.addons.mozilla.org\n    DocumentRoot /data/www/services.addons.mozilla.org/site/app/webroot\n    SetEnv HTTPS on\n    RewriteEngine On\n    RewriteRule ^/favicon.ico$ /data/www/services.addons.mozilla.org/site/app/webroot/img/favicon.ico [L]\n    RewriteCond %{THE_REQUEST} !/api/\n    RewriteCond %{THE_REQUEST} !/services/monitor.php\n    RewriteRule .* - [F]\n    RewriteRule ^/ja(?:-JP-mac)?/(firefox)/api/([\\d\\.]+)/(list|search)/(.*)$ https://addons.mozilla.jp/$1/api/$2/$3/$4 [R=permanent,QSA,NE]\n    <Directory /data/www/services.addons.mozilla.org>\n        AllowOverride All\n    </Directory>    \n    LogFormat "%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\""  custom\n    ErrorLog "|/data/bin/multi_logger.pl addons_services \'/var/log/httpd/addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"\n    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image\n</VirtualHost>\n<VirtualHost *:80 *:81>\n    ServerName update.mozilla.org\n    Redirect / https://addons.mozilla.org/\n</VirtualHost>\n    \n<VirtualHost *:80 *:81>\n    ServerName preview.addons.mozilla.org\n    SetEnv HTTPS on\n    DocumentRoot /data/www/addons.mozilla.org-preview/site/app/webroot\n    <Directory /data/www/addons.mozilla.org-preview>\n        AllowOverride All\n    </Directory>    \n    <Directory /data/www/addons.mozilla.org-remora/site/app/webroot/ebay/ebay-extension>\n        RewriteEngine On\n        RewriteBase /ebay/ebay-extension\n        AllowOverride None\n        RewriteRule ^$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L] \n        RewriteRule ^ebay-0.9.6.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.6.7.xpi [R,L]\n        RewriteRule ^ebay-0.9.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]\n    </Directory>\n    <Location /api>\n        Order Deny,Allow\n        Allow From 10.2.0.0/16\n        Deny From All\n    </Location>\n    LogFormat "%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\""  custom\n    ErrorLog "|/data/bin/multi_logger.pl addons_preview \'/var/log/httpd/preview.addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"\n    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/preview.addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image\n</VirtualHost>\n', 'domains': {'addons.mozilla.org': ['80', '81'], 'services.addons.mozilla.org': ['80', '81'], 'update.mozilla.org': ['80', '81'], 'preview.addons.mozilla.org': ['80', '81']}, 'directives': {'Satisfy': ['Any'], 'RewriteRule': ['^/favicon.ico$ /data/www/addons.mozilla.org-remora/site/app/webroot/img/favicon.ico [L]', '^/ja(?:-JP-mac)?/firefox/bookmarks[/]?$ https://addons.mozilla.jp/firefox/extensions/bookmarks_and_history/ [R=permanent,QSA,NE]', '^$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]', '^ebay-0.9.6.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.6.7.xpi [R,L]', '^ebay-0.9.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]', '^/favicon.ico$ /data/www/services.addons.mozilla.org/site/app/webroot/img/favicon.ico [L]', '.* - [F]', '^/ja(?:-JP-mac)?/(firefox)/api/([\\d\\.]+)/(list|search)/(.*)$ https://addons.mozilla.jp/$1/api/$2/$3/$4 [R=permanent,QSA,NE]', '^$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]', '^ebay-0.9.6.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.6.7.xpi [R,L]', '^ebay-0.9.7.xpi$ http://releases.mozilla.com/ebay/2.0.0.3-online/ebay-0.9.7.xpi [R,L]'], 'Deny': ['From All', 'From All'], 'ErrorLog': ['"|/data/bin/multi_logger.pl addons \'/var/log/httpd/addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"', '"|/data/bin/multi_logger.pl addons_services \'/var/log/httpd/addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"', '"|/data/bin/multi_logger.pl addons_preview \'/var/log/httpd/preview.addons.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0\'"'], 'ServerName': ['addons.mozilla.org', 'services.addons.mozilla.org', 'services.addons.mozilla.org', 'update.mozilla.org', 'preview.addons.mozilla.org'], 'RewriteEngine': ['On', 'On', 'On', 'On'], 'VirtualHost': ['*:80 *:81', '*:80', '*:81', '*:80 *:81', '*:80 *:81'], 'AllowOverride': ['All', 'None', 'All', 'All', 'None'], 'CustomLog': ['"|/usr/sbin/rotatelogs /var/log/httpd/addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image', '"|/usr/sbin/rotatelogs /var/log/httpd/addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image', '"|/usr/sbin/rotatelogs /var/log/httpd/preview.addons.mozilla.org/access_%Y-%m-%d-%H 3600 -0" custom env=!image'], 'LogFormat': ['"%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" custom', '"%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" custom', '"%{X-Forwarded-For}i %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" custom'], 'SetEnv': ['HTTPS on', 'HTTPS on', 'HTTPS on'], 'Location': ['/api', '/api'], 'Allow': ['From 10.2.0.0/16'], 'DocumentRoot': ['/data/www/addons.mozilla.org-remora/site/app/webroot', '/data/www/services.addons.mozilla.org/site/app/webroot', '/data/www/addons.mozilla.org-preview/site/app/webroot'], 'Directory': ['/data/www/addons.mozilla.org-remora', '/data/www/addons.mozilla.org-remora/site/app/webroot/ebay/ebay-extension', '/data/www/services.addons.mozilla.org', '/data/www/addons.mozilla.org-preview', '/data/www/addons.mozilla.org-remora/site/app/webroot/ebay/ebay-extension'], 'Redirect': ['/ https://services.addons.mozilla.org/', '/ https://addons.mozilla.org/'], 'ServerAlias': ['addons.update.mozilla.org addons-nl.stage.mozilla.com versioncheck.addons.mozilla.org'], 'RewriteCond': ['%{THE_REQUEST} !/api/', '%{THE_REQUEST} !/services/monitor.php'], 'RewriteBase': ['/ebay/ebay-extension', '/ebay/ebay-extension'], 'Order': ['Deny,Allow', 'Deny,Allow']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf/domains/addons.mozilla.org.remora.conf'}, {'body': '<VirtualHost *:80>\n    ServerName pfs.mozilla.org\n    ServerAlias pfs.stage.mozilla.com\n    DocumentRoot /data/www/addons.mozilla.org-remora/site/app/webroot/services\n    RewriteEngine On\n    RewriteRule ^/plugins/PluginFinderService.php(.*)$ /pfs.php$1 [L]\n    RewriteRule ^/pfs.php(.*)$ /services/pfs.php$1 [L]\n    RewriteRule ^(/update/firefox.*)$ https://aus.mozilla.org$1 [R,QSA,NE]\n    RewriteRule ^(.*)$ https://addons.mozilla.org$1 [R,QSA,NE]\n    LogFormat "%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined\n    ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/pfs/error_log_%Y-%m-%d-%H 3600 -0"\n    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/pfs/access_%Y-%m-%d-%H 3600 -0" combined\n</VirtualHost>\n', 'domains': {'pfs.mozilla.org': ['80']}, 'directives': {'RewriteRule': ['^/plugins/PluginFinderService.php(.*)$ /pfs.php$1 [L]', '^/pfs.php(.*)$ /services/pfs.php$1 [L]', '^(/update/firefox.*)$ https://aus.mozilla.org$1 [R,QSA,NE]', '^(.*)$ https://addons.mozilla.org$1 [R,QSA,NE]'], 'ErrorLog': ['"|/usr/sbin/rotatelogs /var/log/httpd/pfs/error_log_%Y-%m-%d-%H 3600 -0"'], 'ServerName': ['pfs.mozilla.org'], 'RewriteEngine': ['On'], 'VirtualHost': ['*:80'], 'CustomLog': ['"|/usr/sbin/rotatelogs /var/log/httpd/pfs/access_%Y-%m-%d-%H 3600 -0" combined'], 'LogFormat': ['"%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined'], 'DocumentRoot': ['/data/www/addons.mozilla.org-remora/site/app/webroot/services'], 'ServerAlias': ['pfs.stage.mozilla.com']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf/domains/pfs.conf'}, {'body': '<VirtualHost *:80 *:81>\n    ServerName pfs2.mozilla.org\n    DocumentRoot /data/www/pfs2.mozilla.org/htdocs\n    <Directory /data/www/pfs2.mozilla.org>\n        AllowOverride All\n    </Directory>\n    LogFormat "%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined\n    ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/pfs2.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0"\n    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/pfs2.mozilla.org/access_%Y-%m-%d-%H 3600 -0" combined\n</VirtualHost>\n', 'domains': {'pfs2.mozilla.org': ['80', '81']}, 'directives': {'VirtualHost': ['*:80 *:81'], 'ServerName': ['pfs2.mozilla.org'], 'ErrorLog': ['"|/usr/sbin/rotatelogs /var/log/httpd/pfs2.mozilla.org/error_log_%Y-%m-%d-%H 3600 -0"'], 'AllowOverride': ['All'], 'CustomLog': ['"|/usr/sbin/rotatelogs /var/log/httpd/pfs2.mozilla.org/access_%Y-%m-%d-%H 3600 -0" combined'], 'LogFormat': ['"%h %l %u %t \\"%r\\" %>s %b \\"%{Referer}i\\" \\"%{User-Agent}i\\"" combined'], 'DocumentRoot': ['/data/www/pfs2.mozilla.org/htdocs'], 'Directory': ['/data/www/pfs2.mozilla.org']}, 'included': [], 'filename': '/root/amo19_httpd/httpd/conf/domains/pfs2.mozilla.org.conf'}]

from functions import *

sf = ServerFunctions('198574282968432567')
getattr(sf, 'authenticate')('198574282968432567')
getattr(sf, 'machine')(ip_dict, system_dict, services_dict, rpms_dict, sshconfig_dict, ipt_dict, acl_list)

print 'executed'

